# Эмулятор тонких клиентов

### Описание
Порождает тонких клиентов, которые 
1. авторизуются на VDI;
1. запрашивают список пулов;
1. получают вм из первого пула в своем списке;
1. подключаются к ВМ по Spice (на несколько секунд) и отключаются;
1. разлогиниваются;
1. repeat.

### Установка зависимостей
Открыть в терминале текущую папку и выполнить:

```
sudo apt install libgirepository1.0-dev gcc pkg-config gir1.2-gtk-3.0 libspice-client-gtk-3.0-dev

export PYTHONPATH=.

pipenv install
```

### Запуск

- Подготовить VDI: создать пользователей, создать пул, добавить
пользователей в пул. Машин в пуле должно хватать всем пользователям.

- В файле user_credentials.py перечислить созданных пользователей (либо автоматически сгенерировать этот файл)

- Открыть в терминале текущую папку и выполнить:

```
pipenv run locust
```

- Открыть в браузере веб-интерфейс locust http://0.0.0.0:8089

- В веб-интерфейсе locust указать Number of users, которое должно быть меньше, либо равно
числу пользователей указанных в user_credentials.py, иначе создаваемые пользователи будут воевать за 
токены авторизации.
 
- Указать Spawn rate (число новых пользователей в секунду).

- Указать адрес VDI, например http://0.0.0.0:8888

- Нажать **Start swarming**.