# Расчет CPU

Рекомендуемые количество **vCPU** и **коэффициент переподписки vCPU:CPU** для предлагаемых профилей использования содержатся в разделе [Профили использования](profiles.md).

## Количество vCPU на одну ВМ

Определение необходимого количества выделяемых одной ВМ **vCPU** производится исходя из системных требований предъявляемых к ОС и используемому программному обеспечению, а также по результатам анализа рабочих нагрузок пользователей. 

Анализ нагрузок необходимо выполнять с применением программ мониторинга путем выполнения типичных рабочих задач с использованием ОС и програмного обеспечения, которое планируется использовать в инфраструктуре удаленных рабочих столов.

## Коэффициент переподписки vCPU:CPU

Количество выделенных **vCPU** включенным ВМ может быть больше, чем имеющееся количество **CPU** (количество потоков) в кластере. Соотношение числа выделенных виртуальным машинам **vCPU** к общему количеству **CPU** называется **коэффициент переподписки vCPU:CPU** и считается по формуле ```vCPU/CPU```. 

Для большинства случаев ситуация, когда более **25%** пользователей будут одновременно выполнять ресурсоемкие операции, которые были воспроизведены в нагрузочных тестах, с высоким уровнем использования **vCPU**, является нетипичной. Поэтому, коэффициент переподписки CPU рекомендуется использовать 4, что приводет к увеличению количества пользователей в 4 раза. Однако, в случаях, когда одновременное выполнение операций с высокими нагрузками на  **CPU** большинством количеством пользователей являются типичной ситуацией, а также при выполнении критически важных задач, стоит уменьшить коэффициент переподписки vGPU:GPU до **1÷2**.

Для определения подходящего **коэффициента переподписки CPU** стоит провести анализ активности пользователей и среднего количества одновременного выполнения задач связанных с высокми нагрузками на CPU. 

!!! info "vGPU"
    Для ВМ с vGPU следует использовать **коэффициент переподписки vCPU:CPU** не более 2. Подробная информация содержится в разделе [vGPU]().

## Использование групп ВМ с разным коэффициентом переподписки vCPU:CPU

Для оптимизации работы ВМ используемых для выполнения ресурсоемких и критически важных задач, для которых используется **коэффициент переподписки vCPU:CPU** ниже, чем для остальных ВМ следует использовать отдельные **Пулы ресурсов** для каждой группы вм с одинаковым **коэффициент переподписки vCPU:CPU**.