# Расчет СХД

Основными критериями выбора систем хранения данных помимо отказоустойчивости и стоимости являются **объем** и **производительность**. 

Рекомендуемые **объем и производительность HDD** для предлагаемых профилей использования содержатся в разделе [Профили использования](profiles.md)

## Объем

**Объем** СХД выбирается исходя из сценариев использования ВРС. 

При использовании **тонких клонов** в автоматическом пуле ВМ хранится на СХД только виртуальные диски шаблона и **дельты** (отличия дисков тонкого клона от дисков шаблона), которая формируется из пользовательских файлов. Как правило размер **дельты** находится в пределах 10-30 Гб.

!!! warning "Размер дельты"
    Если сценарии использования **тонких клонов** связанны с изменением большого числа файлов, например обновление или переустановка ОС, размер **дельты** может достигать полного объема используемых виртуальных дисков.

В случаях, когда используются ВМ с виртуальными дисками с предварительно выделенным местом объем, занимаемый такими жесткими дисками, равен полному объему виртуальных дисков.

При использовании ВМ с виртуальными дисками без предварительного выделения места объем, занимаемый такими дисками равен объему информации записанной на эти диски и может составлять от **0%** до **100%** от объема виртуального диска.

Также в **ECP VeiL** предусмотрена возможность хранения образов дисков, резервных копий, и произвольных файлов. Это стоит учитывать при проектировании инфраструктуры.

## Производительность

**Производительность** систем хранения данных это количество операций ввода/вывода, которые может обработать СХД за единицу времени. Несмотря на то, что обычно типовая ВМ при нормальной рабочей нагрузке ВМ требует производительности от **СХД** 10-50 **IOps** , при старте ВМ может создавать нагрузку до 600 **IOps**. Массовый старт вм, например в начале рабочего дня который сопровождается повышенным количеством обращений к системам хранения данных, называется **Boot Storm**. 

Во время **Boot Storm** соотношение операций на чтение/запись обычно составляет около **80/20**, при этом максимальное количество **IOps**, которое генерирует 1 виртуальная машина при старте может составлять до **600 IOps**. При нормальной работе, т.е. после завершения **Boot Storm**, соотношение операций на чтение/запись обычно составляет около **20/80**, однако и количество **IOps** генерируемых одной ВМ составляет 10-50 **IOps**. Следует учитывать количество и соотношение одновременно запускаемых и работающих ВМ при проектировании инфраструктуры, и выборе **СХД**.

Несмотря на то что, каждая ВМ при загрузке ОС может генерировать нагрузку с соотношением операций на чтение/запись **80/20** до **600 IOps** допускается эксплуатацния СХД с производительностью от **150 IOps** в расчете на одну ВМ осознанным снижением производительности ВМ во время **BootStorm**.

В некоторых случаях реальные показатели производительности могут отличатся от расчетных, например в случае использования СХД с низкой производительностью и одновременном массовом обновлении ПО с перезагрузкой время отклика дисковых подсистем BM может сильно возрасти.  