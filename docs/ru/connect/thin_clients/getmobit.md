# GM Smart System (Getmobit)

**GM Smart System** --- это решение Enterprise уровня для создания единого рабочего окружения конечных пользователей и обеспечения унифицированного безопасного доступа к виртуальной инфраструктуре, телефонной связи и видеоконференциям, а также централизованного управления пользовательским компьютерным оборудованием и сервисами.

**ECP VeiL** и **VeiL VDI** имеет полную программную совместимость и обеспечивает корректную работу с линейкой продуктов **GM Smart System**.

### Документация необходимая для работы с GM Smart System (доступна на вкладке "Документы" в [личном кабинете пользователя Getmobit](https://lk.getmobit.ru/cabinet-user/index)): {#gm-docs}

* [Руководство администратора](https://lk.getmobit.ru/cabinet-user/download-doc/49);

* [Руководство пользователя](https://lk.getmobit.ru/cabinet-user/download-doc/47);

* [Требования к инфраструктуре](https://lk.getmobit.ru/cabinet-user/download-doc/40).

### Программные продукты используемые в работе GM Smart System (доступны на вкладке "Файлы" в [личном кабинете пользователя Getmobit](https://lk.getmobit.ru/cabinet-user/index)): {#gm-files}

* Сервер управления (GM Server);

* Система мониторинга (GM Server Monitoring);

* Программное обеспечение GM-Box (GM-OS);

* Приложение VeiL Connect в формате SDApp (SD App Masshtab VeiL).

## Подготовка окружения {#env-prep}

### Инфраструктура VeiL {#veil-env}

Для начала использования системы на базе решения **GM-Box** из линейки продуктов **GM Smart System** необходимо подготовить следующее:

1. Развернуть и настроить облачную платформу **ECP VeiL**, как указано в [руководстве](https://veil.mashtab.org/docs/latest/).

1. Развернуть и настроить брокер подключений **VeiL VDI** --- **VeiL Broker** согласно [руководству](https://veil.mashtab.org/vdi-docs/broker/engineer_guide/install/).

### Подготовка виртуальных машин (ВМ) {#virt-machines}

1. Используя подготовленную инфраструктуру VeiL [развернуть ВМ](https://veil.mashtab.org/docs/latest/base/operator_guide/domains/create/) для установки GM Server. Параметры ВМ должны соответствовать следующим рекомендованным аппаратным требованиям (актуальные данные доступны в документе "Требования к инфраструктуре"):

    - Виртуальная машина для сервера управления:

        * Минимум 2 vCPU (ядра процессора)

        * Минимум 16 GB RAM

        * 100 GB HDD

    - Выделенный статический IP-адрес, A-запись в DNS с именем getmobit.example.site 

    - Операционная система Ubuntu 16.04, 64bit (или Linux based операционная с поддержкой пакета docker версии не ниже 17.09.0 и менеджера deb пакетов)

1. Аналогично предыдущему пункту небходимо подготовить необходимое количество ВМ для последующих подключений через **VeiL Connect** интегрированный в приложение для **GM-Box**.

### Настройка сети {#network-setup}

Для работы устройства GM-Box рекомендуется использовать сервис DHCP, представляющий следующую информацию:

* выдаваемый IP-адрес;

* название домена;

* IP-адрес шлюза по умолчанию;

* IP-адрес сервера имён (DNS);

* IP-адрес сервера точного времени (NTP);

* для автоматического поиска Сервера управления (GM Server) необходимо указать локальный домен в DHCP option 119 --- 'Domain Search List'.

### Установка сервера управления (СУ) GM Server {#gmserver-on}

Установка сервера управления осуществляется согласно "Руководству администратора":

!!! attention "Внимание!"
    Для выполнения работ по инсталляции, обновлению, и перезапуску Сервера управления, установки TLS/SSL сертификатов и настройки параметров операционной системы, необходим доступ к виртуальной машине по ssh (openssh, PUTTY и др. программы) с правами суперпользователя (root). Штатная эксплуатация Сервера управления осуществляется только с использованием веб-консоли Сервера управления.

Установку GM-Server можно выполнить из deb-пакета для Ubuntu 16.04 (x64).

1. Установите Docker CE [согласно инструкции](https://docs.docker.com/install/linux/docker-ce/ubuntu/)

1. Установите пакет Сервера управления пользователем с правами суперпользователя (root): 

    `sudo dpkg -i gmserver_[VERSION]_amd64.deb`
    где [VERSION] --- номер версии.

!!! attention "Внимание!"
    Все действия выполняются пользователем с правами суперпользователя (root).
    Для выполнения команд и настроек с правами суперпользователя (root) рекомендуется использовать команду **sudo**.
    Пароль для суперпользователя (root) должен формироваться, храниться и меняться в соответствии с парольными политиками, принятыми в организации.

### Установка системы мониторинга GM Server Monitoring

Установка сервера управления осуществляется согласно "Руководству администратора".

### Настройка СУ GM Server {#gmserver-setup}

Настройка СУ производится с помощью веб-интерфейса GM Server, для перехода к последнему следует открыть с помощью браузера страницу, расположенную по IP-адресу ВМ на которую был установлен СУ, либо, при наличии записи в DNS, по адресу getmobit.example.site

В открывшейся форме следует ввести логин и пароль, значения по умолчанию:

Login: superadmin

Password: superadmin

#### Добавление пользователя

Для авторизации пользователя в системе доступны локальная учётная запись, а также учётные записи AD.

Производится из меню СУ **Пользователи** -- **Добавить**

В появившемся окне **Пользователь** необходимо заполнить следующую информацию:

- **Учетная запись** : gm_user

- **Пароль** : gm_pass

- **Роль** : USER

- **Режим GM-Box** : VeiL

- **VDI хост** : IP-адрес VeiL Broker

- **VDI пользователь** : veil_user

- **VDI пароль** : veil_pass

Таким образом, пользователь GM-Box **gm_user** будет ассоциирован с пользователем VeiL VDI (Broker) **veil_user**, что позволит после входа в GM-Box миновать окно авторизации VeiL Connect, так как учётные данные для последнего будут подставлены автоматически.

!!! tip "Рекомендация"
    При использовании учетной записи AD следует указать логин и пароль аналогично вышеуказанному, в полях **VDI пользователь** и **VDI пароль**. Так как именно эти данные будут переданы в окно входа приложения VeiL Connect и, для авторизации, останется отметить checkbox **LDAP**. При последующих входах авторизация будет происходить автоматически, так как состояние checkbox'a **LDAP** сохранится.

Рекомендации по настройке работы систем со службой каталогов AD находятся в разделе [Использование для авторизации службы каталогов AD](#using-ad)

## Начало работы с устройством GM-Box {#gmbox-on}

Ввод в эксплуатацию производится согласно "Руководству пользователя":

1. Подключение устройства

    - Присоедините к панели разъемов все необходимые устройства (клавиатуру, мышь, монитор(ы))

    !!! info
        В зависимости от конкретной модели используемого устройства панель разъемов может иметь те или иные порты и коннекторы, для присоединения внешних приборов и устройств необходимо следовать указаниям из главы "Подключение устройства" из "Руководства пользователя".

    - Подключите GM-Box к сети (в зависимости от модели устройства и архитектуры сети это может быть проводная (Ethernet) или беспроводная сеть (Wi-Fi, сотовая сеть LTE)).

    - Присоедините адаптер питания согласно руководству пользователя.

### Обновление программного обеспечения GM-Box {#gmbox-update}

Выполняется согласно главе "Настройка и управление GM-Box" из документа "Руководство администратора":

1. В веб-интерфейсе GM Server через **Обновления** -- **Добавить** следует загрузить скачанный файл "Программное обеспечение GM-Box (GM-OS)" --- mainline_[VERSION].swu.

1. Далее используя **Задания** -- **Добавить** ввести:

    - **название задания** : обновление GM-Box

    - **Назначить на** : выбрать подключенное устройство

    - **Однократно**

    - **Команда** : Device Update & Reboot

    - **ID обновления** : mainline_[VERSION].swu

1. Нажать сохранить и дождаться перезапуска устройства.

### Установка программного обеспечения VeiL Connect {#veilcon-install}

1. В веб-интерфейсе GM Server через **Приложения** -- **Добавить** следует загрузить скачанный файл "Приложение VeiL Connect в формате SDApp (SD App Masshtab VeiL)" --- Mashtab-Veil_[VERSION].swu.

1. Далее используя **Задания** -- **Добавить** ввести:

    - **название задания** : установка VeiL Connect

    - **Назначить на** : выбрать подключенное устройство

    - **Однократно**

    - **Команда** : Install Application & Reboot

    - **ID обновления** : Mashtab_Veil_[VERSION].swu

1. Нажать сохранить и дождаться перезапуска устройства.

### Вход в систему GM-Box {#gmbox-login}

После включения GM-Box и загрузки системы на экране монитора появится окно для авторизации **Вход в систему**, для входа следует использовать следующие данные:

**Имя пользователя** : gm_user

**Пароль** : gm_pass

В случае, если вход не происходит следует проверить настройки согласно главе "Подключение к сети" из "Руководства пользователя".

Если после успешного входа откроется окно авторизации VeiL Connect следует проверить/ввести верные данные для учётной записи VeiL Broker и/или установить/снять отметку с checkbox **LDAP**.

После выполнения вышеуказанных действий откроется окно VeiL Connect предоставляющее выбор ВМ для подключения. Операции с данным окном выполняются согласно руководству с [описанием "Окна доступных пулов ВМ"](https://veil.mashtab.org/vdi-docs/connect/operator_guide/pools/).

### Использование для авторизации службы каталогов AD {#using-ad}

#### GM Smart System {#gm_ad}

Для корректной настройки синхронизации данных с корпоративной службой каталогов следует обратиться к "Руководству Администратора":

1. В веб-панели управления GM Server используя **Настройки** -- **Синхронизация с AD** заполнить следующие поля:

    - **AD Сервер** : IP-адрес сервера AD

    - **AD Порт** : порт для подключения к серверу AD (по умолчанию 389)

    - **Логин** : имя пользователя AD

    - **Пароль** : пароль пользователя AD

1. После ввода данных нажать кнопку проверить.

1. Обновить страницу браузера и убедиться, что **Статус** изменился на **Синхронизация запущена**.

#### VeiL VDI {#veil_ad}

Настройка работы VeiL Broker со службой каталогов производится [согласно указаниям](https://veil.mashtab.org/vdi-docs/broker/operator_guide/ad/).
